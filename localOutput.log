> source("/Users/ncooper/github/plumbCNV_Example/run_example.R")

Plink installation detected

Found hidden markov parameter file lib/hh550.hmm.
Modify parameters therein; B1_uf, B2_uf, B3_uf, from 0.01 to 0.03,if using Affymetrix arrays

PennCNV installation detected

Validating required files for plumbCNV assuming:
 *     Mode 1: run the pipeline starting from a raw genome studio file, using file.spec.txt 
 * Snp mode 1: run SNP-QC using snpStats package [NB: must have genotype data] 

Found 'file.spec.txt', so will attempt to use information from this file to adjust import settings
plumbCNV file check successful

######################
# 0. DATA EXTRACTION #
######################


Running bash data import script
/Users/ncooper/github/plumbCNV_Example/pipesDisease/SCRIPTS/getDataGS.sh -lSMG -N 3 -T 'LRR' -F '/Users/ncooper/github/plumbCNV_Example/genomeStudioRawFiles/' -O '/Users/ncooper/github/plumbCNV_Example/pipesDisease/' -m '/Users/ncooper/github/plumbCNV_Example/genomeStudioRawFiles/lab1dataset.txt.tar.gz' 

Options in use are:
-------------------
MaxSnp: 2000000
Datatype: LRR
Max number of cores: 3
Filename with Chr,Pos,Snp support information: /Users/ncooper/github/plumbCNV_Example/genomeStudioRawFiles/lab1dataset.txt.tar.gz
Generate Plink .Map file using support filename above?: yes
SNP location support file is in genome studio format?: yes
Location of main CNV directory (output then to /...DATA/RAWDATA/): /Users/ncooper/github/plumbCNV_Example/pipesDisease 
Directory containing raw data files: /Users/ncooper/github/plumbCNV_Example/genomeStudioRawFiles
Get SNP/Sample IDs?: yes
Make Plink LGEN file?: no
Make fake Plink family file?: no
Write file lengths to file?: yes
Combine all into 1 file?: no
If combining, delete separate files?: no
Skip main extraction?: no
Remove non-autosomes prior to sample QC in Plink?: no
Do QC in Plink?: no

Plink settings seem ok
Extracting LRR data from genome studio file
2 datafiles expected
extracting snp list...
ID0001
extracting ID list...
file 1
file 2
ID0001 ID0002 ID0003 ID0004 ID0005 ID0006 ID0007 ID0008 ID0009 ID0010 ID0011 ID0012 ID0013 ID0014 ID0015 ID0016 ID0017 ID0018 ID0019 ID0020 ID0021 ID0022 ID0023 ID0024 ID0025 ID0026 ID0027 ID0028 ID0029 ID0030 ID0031 ID0032 ID0033 ID0034 ID0035 ID0036 ID0037 ID0038 ID0039 ID0040 ID0041 ID0042 ID0043 ID0044 ID0045 ID0046 ID0047 ID0048 ID0049 ID0050 ID0051 ID0052 ID0053 ID0054 ID0055 ID0056 ID0057 ID0058 ID0059 ID0060 ID0061 ID0062 ID0063 ID0064 ID0065 ID0066 ID0067 ID0068 ID0069 ID0070 ID0071 ID0072 ID0073 ID0074 ID0075 ID0076 ID0077 ID0078 ID0079 ID0080 ID0081 ID0082 ID0083 ID0084 ID0085 ID0086 ID0087 ID0088 ID0089 ID0090 ID0091 ID0092 ID0093 ID0094 ID0095 ID0096 ID0097 ID0098 ID0099 ID0100
nidfiles: 2
found 2 *.id files for cohorts, combined to subIdsALL.txt
/Users/ncooper/github/plumbCNV_Example/pipesDisease/LRRDATA/RAWDATA
found 100 subject IDs
found 15338 snp IDs
Assuming genome studio format, which means a file header, then a line containing the text [Data]
followed by row of headers, then the actual long format data
extracting LRR from column 13 of /Users/ncooper/github/plumbCNV_Example/genomeStudioRawFiles/lab1dataset.txt.tar.gz
extracting LRR from column 13 of /Users/ncooper/github/plumbCNV_Example/genomeStudioRawFiles/lab2dataset.txt.tar.gz
getting lengths of vector format data files, writing to file.lengths.txt
complete
Extracting SNP info from genome studio type file:  /Users/ncooper/github/plumbCNV_Example/genomeStudioRawFiles/lab1dataset.txt.tar.gz
applying any custom column settings -abcd if they exist
parsing gzip file.
[assuming sample-id in 1, chr in col 3, pos in col 4, snp-label in col 2]
if any of these column numbers are wrong please modify mSampCol, mchrCol, mposCol, mSnpCol in this script
extracting from zip file (*.gz)
snpdata.map file created successfully, preview:
chr snp-id pos
1	chr1_171422483	171422483
11	chr11_76048775	76048775
11	chr11_76048907	76048907
11	chr11_76049066	76049066
11	chr11_76049353	76049353

Running bash data import script for BAF data
/Users/ncooper/github/plumbCNV_Example/pipesDisease/SCRIPTS/getDataGS.sh -N 3 -T 'BAF' -F '/Users/ncooper/github/plumbCNV_Example/genomeStudioRawFiles/' -O '/Users/ncooper/github/plumbCNV_Example/pipesDisease/' 

Options in use are:
-------------------
MaxSnp: 2000000
Datatype: BAF
Max number of cores: 3
Filename with Chr,Pos,Snp support information: ./support.txt
Generate Plink .Map file using support filename above?: no
SNP location support file is in genome studio format?: no
Location of main CNV directory (output then to /...DATA/RAWDATA/): /Users/ncooper/github/plumbCNV_Example/pipesDisease 
Directory containing raw data files: /Users/ncooper/github/plumbCNV_Example/genomeStudioRawFiles
Get SNP/Sample IDs?: no
Make Plink LGEN file?: no
Make fake Plink family file?: no
Write file lengths to file?: no
Combine all into 1 file?: no
If combining, delete separate files?: no
Skip main extraction?: no
Remove non-autosomes prior to sample QC in Plink?: no
Do QC in Plink?: no

Plink settings seem ok
In BAF mode plink options are reset to 'no'
In BAF mode usually assumes LRR has already been extracted and so snp and sample lists are present already
Extracting BAF data from genome studio file
2 datafiles expected
Assuming genome studio format, which means a file header, then a line containing the text [Data]
followed by row of headers, then the actual long format data
extracting BAF from column 12 of /Users/ncooper/github/plumbCNV_Example/genomeStudioRawFiles/lab1dataset.txt.tar.gz
extracting BAF from column 12 of /Users/ncooper/github/plumbCNV_Example/genomeStudioRawFiles/lab2dataset.txt.tar.gz
complete
imports using bash scripts, complete!
 changed specified 'grps' in data.tracker to match file.spec.txt

Retrieving Plate/Well information from lookup table:
 taking id, plate from columns: id, plate 
 file preview:
  V1             V2        V3
1  1 chr1_171422483 171422483
2 11 chr11_76048775  76048775
3 11 chr11_76048907  76048907
4 11 chr11_76049066  76049066

 98 % of big.matrix indices in sort.list
 using /Users/ncooper/github/plumbCNV_Example/pipesDisease/ANNOTATION/SNP_SORT/snpsort.txt to sort snps 
~wrote excluded non-autosome snp list to: /Users/ncooper/github/plumbCNV_Example/pipesDisease/ANNOTATION/SNP_EXCLUDE/ 
num.filz: 2 (integer, 1)
id.fnz (character, 2) [head]:
[1] "lab1dataset.txt.tar.gz.ids" "lab2dataset.txt.tar.gz.ids"

file.info (data.frame, 2*9)
                    FILE GRP TYPE SAMP SNP A1 A2 LRR BAF
1 lab1dataset.txt.tar.gz   1 gzip    1   2  6  7  13  12
2 lab2dataset.txt.tar.gz   1 gzip    1   2  6  7  13  12

path.fn (character, 2) [head]:
[1] "/Users/ncooper/github/plumbCNV_Example/pipesDisease/LRRDATA/SAMPLEFILES/lab1dataset.txt.tar.gz.ids" "/Users/ncooper/github/plumbCNV_Example/pipesDisease/LRRDATA/SAMPLEFILES/lab2dataset.txt.tar.gz.ids"

 searching for raw datafiles in processed long format (e.g, converted from GenomeStudio)
 all 2 expected data files found in /Users/ncooper/github/plumbCNV_Example/pipesDisease/LRRDATA/RAWDATA/ 
 searching for raw datafiles in processed long format (e.g, converted from GenomeStudio)
 all 2 expected data files found in /Users/ncooper/github/plumbCNV_Example/pipesDisease/BAFDATA/RAWDATA/ 

##################
# 1. DATA IMPORT #
##################

 no pre-existing BAF big.matrix, or 'delete=T', importing now from text file
 getting all ID lists ignoring group [1 groups]
 reading snps from /Users/ncooper/github/plumbCNV_Example/pipesDisease/ANNOTATION/snpNames.txt 
 found 100 samples and 15338 markers
reading a single cohort from 2 source files.
 found 100 column names and 15338 marker names

 deleting /Users/ncooper/github/plumbCNV_Example/pipesDisease/BIGMATRICES/BAF.dsc 

Creating big matrix object to store group data
 predicted disk use:  0 GB
 opening connection to long format datafile (1/2): lab1dataset.txt.tar.gz.BAF.dat

Loading text data into big matrix object:
0         25%         50%         75%         100%
..................................................
 opening connection to long format datafile (2/2): lab2dataset.txt.tar.gz.BAF.dat

Loading text data into big matrix object:
0         25%         50%         75%         100%
..................................................

 created big.matrix description file: BAF.dsc 
 created big.matrix backing file: BAF.bck 

Running import for 1 cohort(s)
 getting ID list(s) for group 1 
 reading snps from /Users/ncooper/github/plumbCNV_Example/pipesDisease/ANNOTATION/snpNames.txt 
 found 100 samples and 15338 markers
reading a single cohort from 2 source files.
 found 100 column names and 15338 marker names

 deleting /Users/ncooper/github/plumbCNV_Example/pipesDisease/BIGMATRICES/LRR.dsc 

Creating big matrix object to store group data
 predicted disk use:  0 GB
 opening connection to long format datafile (1/2): lab1dataset.txt.tar.gz.LRR.dat

Loading text data into big matrix object:
0         25%         50%         75%         100%
..................................................
 opening connection to long format datafile (2/2): lab2dataset.txt.tar.gz.LRR.dat

Loading text data into big matrix object:
0         25%         50%         75%         100%
..................................................

 created big.matrix description file: LRR.dsc 
 created big.matrix backing file: LRR.bck 

##########################
# 2. SNP QUALITY CONTROL #
##########################

 file preview:
  V1             V2        V3
1  1 chr1_171422483 171422483
2 11 chr11_76048775  76048775
3 11 chr11_76048907  76048907
4 11 chr11_76049066  76049066

~wrote excluded non-autosome snp list to: /Users/ncooper/github/plumbCNV_Example/pipesDisease/ANNOTATION/SNP_EXCLUDE/ 

Importing SNP data into R using snpStats package
 reading file lengths of raw datafiles from file.lengths.txt 

Time estimates for importing SNP data:
     ~ mins to process Raw file name                 
[1,] 0.1               lab1dataset.txt.tar.gz.LRR.dat
[2,] 0.1               lab2dataset.txt.tar.gz.LRR.dat
[3,] 0.2               All files                     
Files contain: 60,40 samples, respectively

 reading 2 long format SNP files using 2 cores in parallel...
~wrote snpMatLst to: /Users/ncooper/github/plumbCNV_Example/pipesDisease/SNPQC/snpMatLst.RData 
 reordering/selecting markers from SnpMatrices 1 to 2 ...done

Generating report (sample)
           CallRate Samples Percent
1    callrate < 0.5       0      0%
2   callrate < 0.75       0      0%
3    callrate < 0.9       0      0%
4   callrate < 0.95       0      0%
5  callrate >= 0.95     100    100%
6  callrate >= 0.97      42     42%
7  callrate >= 0.99       0      0%
8 callrate >= 0.999       0      0%

~wrote file with samples call rate QC summary to:
  /Users/ncooper/github/plumbCNV_Example/pipesDisease/SNPQC/sampleqc.txt 
~wrote file with samples to exclude because of low call rate:
  /Users/ncooper/github/plumbCNV_Example/pipesDisease/ANNOTATION/SAMPLE_EXCLUDE/callrate.txt 
~wrote file with samples to exclude because of heterozygosity outside (0.1,0.4):
 /Users/ncooper/github/plumbCNV_Example/pipesDisease/ANNOTATION/SAMPLE_EXCLUDE/hz.txt
 reordering/selecting samples from SnpMatrix files 1 to 2 ...done
~wrote 3239 suspected monomorphic snps to:
  /Users/ncooper/github/plumbCNV_Example/pipesDisease/SNPQC/monomorphic.txt 

Generating report (snp)
           CallRate  SNPs Percent
1    callrate < 0.5   341   2.27%
2   callrate < 0.75   421    2.8%
3    callrate < 0.9   563   3.75%
4   callrate < 0.95   678   4.51%
5  callrate >= 0.95 14352  95.49%
6  callrate >= 0.97 14237  94.72%
7  callrate >= 0.99 13986  93.05%
8 callrate >= 0.999 13459  89.55%

~wrote file with snp call rate and HWE QC summary to:
  /Users/ncooper/github/plumbCNV_Example/pipesDisease/SNPQC/snpqc.txt 
~wrote file with call rate failing snps to:
  /Users/ncooper/github/plumbCNV_Example/pipesDisease/ANNOTATION/SNP_EXCLUDE/callrate.txt 
~wrote HWE exclusion list to annotion directory
 deleting: /Users/ncooper/github/plumbCNV_Example/pipesDisease/ANNOTATION/SNP_SORT/snpsort.txt 
replacing any files in directory /ANNOTATION/SNP_SORT/ with new sorted snp list
~wrote file: /Users/ncooper/github/plumbCNV_Example/pipesDisease/ANNOTATION/SNP_SORT/snpsort.txt 
 generating venn diagrams
~wrote Venn figure to file: /Users/ncooper/github/plumbCNV_Example/pipesDisease/SNPQC/venn_95.pdf 
 generating density plots
~wrote density figure to file: /Users/ncooper/github/plumbCNV_Example/pipesDisease/SNPQC/callRateDistributions.pdf 
HWE data for 0 monomorphic SNPs was ignored
wrote file: /Users/ncooper/github/plumbCNV_Example/pipesDisease/SNPQC/HWEDistribution.pdf 
wrote file /Users/ncooper/github/plumbCNV_Example/pipesDisease/SNPQC/HZDistribution.pdf 
wrote file: /Users/ncooper/github/plumbCNV_Example/pipesDisease/SNPQC/HWEvsCallrate.pdf 
==> full info object written to: /Users/ncooper/github/plumbCNV_Example/pipesDisease/ANNOTATION/sampleinfo.tab 
==> full info object written to: /Users/ncooper/github/plumbCNV_Example/pipesDisease/ANNOTATION/snpinfo.RData 
~wrote sampleinfo.tab, snpinfo.tab to:
  /Users/ncooper/github/plumbCNV_Example/pipesDisease/ANNOTATION/ 
SNP-QC removed a total of 0 samples and 686 SNPs

#############################
# 3. SAMPLE QUALITY CONTROL #
#############################

 initializing sample-QC exclusion files
 100/100 samples successfully assigned groups

Running sample QC for 1 cohort(s)

Processing data import and sample QC for cohort 1 of 1 

Loading big matrix from descriptor file /Users/ncooper/github/plumbCNV_Example/pipesDisease/BIGMATRICES/LRR.RData :

Excluding samples/snps with SNP-QC failures, sorting SNPs by chr, pos:
 attached matrix with dims: 15338,100 
 excluding and ordering listed samples based on annotation directory files; SNP/SAMP
 calculating exclusions and order
 100 % of big.matrix indices in sort.list
 using /Users/ncooper/github/plumbCNV_Example/pipesDisease/ANNOTATION/SAMPLE_SORT/subIdsALL.txt to sort samples 
 98 % of big.matrix indices in sort.list
 using /Users/ncooper/github/plumbCNV_Example/pipesDisease/ANNOTATION/SNP_SORT/snpsort.txt to sort snps 
 starting deep copy...done
Big matrix with: 14344 rows, 100 columns
 - data type: numeric 

                    colnames 
 Row#      rownames   ID0001   ID0002  .....    ID0100 
    1 imm_1_7722552  -0.3457  -0.3033   ...    -0.3835 
    2 imm_1_7722929  -0.0482  -0.0999   ...    -0.0683 
    3 imm_1_7723190  -0.0129  -0.0722   ...    -0.0861 
   ..          ....      ...      ...   ...        ... 
14344     rs8139123  -0.2366  -0.4045   ...     -0.216 


Calculating sample-wise statistics for LRR
 calculating column means...took 0 seconds
 calculating column SDs...took 0 seconds
 calculating column DLRS (apply method) ...took 0.8 seconds

Adding GC wave to LRR stats, be aware this can be slow
 doing median calculation
0         25%         50%         75%         100%
..................................................
 took 0 hours
 calculating Diskin constants...
~wrote boxplot:
  /Users/ncooper/github/plumbCNV_Example/pipesDisease/SAMPLEQC/MEAN_DLRS_GC/LRRDistributionsBoxPlot.pdf 
~wrote table
 /Users/ncooper/github/plumbCNV_Example/pipesDisease/SAMPLEQC/MEAN_DLRS_GC/LRRStatsPerSample.tab 


Cohort distribution statistics for LRR-stats:
            Mean     DLRS    GCWave
   Mean  -0.0132   0.1663   -0.0415
     SD   0.0138   0.0229     0.017
    Min  -0.0824   0.1333   -0.0768
     Q1   -0.018   0.1521   -0.0496
 Median  -0.0116   0.1609   -0.0421
     Q3  -0.0067   0.1772    -0.033
    Max   0.0099   0.2791    0.0576
     LB  -0.0351   0.1145   -0.0745
     UB   0.0103   0.2148   -0.0081
   -2SD  -0.0407   0.1205   -0.0755
   +2SD   0.0144   0.2121   -0.0076
 -3.5SD  -0.0614   0.0861    -0.101
 +3.5SD   0.0351   0.2465    0.0179
  Low1%  -0.0824   0.1333   -0.0768
   Hi1%   0.0079   0.2479    0.0177

~appended 3 to sample list: /Users/ncooper/github/plumbCNV_Example/pipesDisease/ANNOTATION/SAMPLE_EXCLUDE/Mean.txt 
~appended 3 to sample list: /Users/ncooper/github/plumbCNV_Example/pipesDisease/ANNOTATION/SAMPLE_EXCLUDE/DLRS.txt 
~appended 1 to sample list: /Users/ncooper/github/plumbCNV_Example/pipesDisease/ANNOTATION/SAMPLE_EXCLUDE/GCWave.txt 
~wrote file: /Users/ncooper/github/plumbCNV_Example/pipesDisease/SAMPLEQC/MEAN_DLRS_GC/LRRMean+DLRS+GCWave.pdf 

Plotting extreme samples for combinations of: Mean vs GC vs DLRS
0         25%         50%         75%         100%
..................................................
~wrote 3 files:
/Users/ncooper/github/plumbCNV_Example/pipesDisease/SAMPLEQC/EXAMPLES;
  Mean+DLRSSampleID0012LRR.pdf
  Mean+DLRS+GCWaveSampleID0008LRR.pdf
  NoneSampleID0070LRR.pdf

~wrote file(s):
  LRRDLRSvsMean.pdf 
  LRRGCWavevsMean.pdf 
  LRRGCWavevsDLRS.pdf 


~wrote empty chr.ab excluded subject list to: /Users/ncooper/github/plumbCNV_Example/pipesDisease/ANNOTATION/SAMPLE_EXCLUDE/ChrAb.txt 

Performing plate QC
callrate.txt 0/0 in this cohort
ChrAb.txt 0/1 in this cohort
DLRS.txt 3/3 in this cohort
GCWave.txt 1/1 in this cohort
Mean.txt 3/3 in this cohort

Table of Plate failure counts:
        ID CallRate Mean DLRS ChrAb GCWave TOTAL SIZE PC+CR
1  PLT0001        0    3    3     0      1     3   12  0.25
2  PLT0002        0    0    0     0      0     0    1  0.00
3  PLT0003        0    0    0     0      0     0   12  0.00
4  PLT0004        0    0    0     0      0     0   12  0.00
5  PLT0005        0    0    0     0      0     0   12  0.00
6  PLT0006        0    0    0     0      0     0   12  0.00
7  PLT0007        0    0    0     0      0     0   12  0.00
8  PLT0008        0    0    0     0      0     0   12  0.00
9  PLT0009        0    0    0     0      0     0   12  0.00
10 PLT0010        0    0    0     0      0     0    3  0.00
written to /Users/ncooper/github/plumbCNV_Example/pipesDisease/SAMPLEQC/PLATES/CountsPerPlateLRR.tab 

Testing for plates where more than 40% of samples fail QC (including callrate) 
~appended bad plate excluded subject list:
  /Users/ncooper/github/plumbCNV_Example/pipesDisease/ANNOTATION/SAMPLE_EXCLUDE/BadPlates.txt 
~table of LRR-statistics by Plate, written to:
 /Users/ncooper/github/plumbCNV_Example/pipesDisease/SAMPLEQC/PLATES/StatsPerPlateLRR.tab
~wrote file: /Users/ncooper/github/plumbCNV_Example/pipesDisease/SAMPLEQC/PLATES/plateBoxPlotsMDGLRR.pdf 

Excluding samples/snps with SNP-QC failures, sorting SNPs by chr, pos:
 attached matrix with dims: 14344,100 
 excluding and ordering listed samples based on annotation directory files; SNP/SAMP
 calculating exclusions and order
 100 % of big.matrix indices in sort.list
 using /Users/ncooper/github/plumbCNV_Example/pipesDisease/ANNOTATION/SAMPLE_SORT/subIdsALL.txt to sort samples 
 100 % of big.matrix indices in sort.list
 using /Users/ncooper/github/plumbCNV_Example/pipesDisease/ANNOTATION/SNP_SORT/snpsort.txt to sort snps 
 0 samples to remove (across all groups), found in BadPlates.txt 
 0 samples to remove (across all groups), found in callrate.txt 
 1 samples to remove (across all groups), found in ChrAb.txt 
 3 samples to remove (across all groups), found in DLRS.txt 
 0 samples to remove (across all groups), found in GCWave.txt 
 0 samples to remove (across all groups), found in hz.txt 
 0 samples to remove (across all groups), found in Mean.txt 
 678 Snps to remove, found in callrate.txt 
 8 Snps to remove, found in HWE.txt 
 308 Snps to remove, found in nonAutosomes.txt 

Reordering SNPs and Samples...

INDEXES SUMMARY
14344 row indexes range is from 1 to 14344 
-->, 1, 2, 3, 4, 5, 6
97 col indexes range is from 1 to 100 
-->, 1, 2, 3, 4, 5, 7

 raw big.matrix summary before ordering and exclusion based on SNP-QC:

Big matrix with: 14344 rows, 100 columns
 - data type: numeric 

                    colnames 
 Row#      rownames   ID0001   ID0002  .....    ID0100 
    1 imm_1_7722552  -0.3457  -0.3033   ...    -0.3835 
    2 imm_1_7722929  -0.0482  -0.0999   ...    -0.0683 
    3 imm_1_7723190  -0.0129  -0.0722   ...    -0.0861 
   ..          ....      ...      ...   ...        ... 
14344     rs8139123  -0.2366  -0.4045   ...     -0.216 

 starting deep copy...done

Adding names
 added colnames
 added rownames
 due to use of deep copy option, recommend only to use descr saved as rbinary description file
 created big.matrix description file: SampQC_CombinedSortdescrFile 
 created big.matrix backing file: SampQC_CombinedSortbckfile 
 created big.matrix binary description file: SampQC_CombinedSortdescrFile.RData 
~wrote file of sample IDs passing all QC to:
  /Users/ncooper/github/plumbCNV_Example/pipesDisease/ANNOTATION/PassQCSamples.txt 

counts
              Mean    DLRS   ChrAb   GCWave
      Mean       3       3       0        1
      DLRS       3       3       0        1
     ChrAb       0       0       1        0
    GCWave       1       1       0        1
 No Others       0       0       0        0

percent of failers
              Mean    DLRS   ChrAb   GCWave
      Mean    0.75    0.75       0     0.25
      DLRS    0.75    0.75       0     0.25
     ChrAb       0       0    0.25        0
    GCWave    0.25    0.25       0     0.25
 No Others       0       0       0        0

percent of callrate passing sample
              Mean    DLRS   ChrAb   GCWave
      Mean    0.03    0.03       0     0.01
      DLRS    0.03    0.03       0     0.01
     ChrAb       0       0    0.01        0
    GCWave    0.01    0.01       0     0.01
 No Others       0       0       0        0

Frequency count of number of separate QC indices failed per sample
         count         %
 none       97        97
    3        2         2
  All        1         1

~wrote QC summary to:
  /Users/ncooper/github/plumbCNV_Example/pipesDisease/SAMPLEQC/MEAN_DLRS_GC/QCsummaryTable.txt 
mean sample call rate is now: 0.9998742
Generating report (sample)
           CallRate Samples Percent
1    callrate < 0.5       0      0%
2   callrate < 0.75       0      0%
3    callrate < 0.9       0      0%
4   callrate < 0.95       0      0%
5  callrate >= 0.95      97    100%
6  callrate >= 0.97      97    100%
7  callrate >= 0.99      97    100%
8 callrate >= 0.999      97    100%

==> full info object written to: /Users/ncooper/github/plumbCNV_Example/pipesDisease/ANNOTATION/sampleinfo.tab 

##################################
# 4. PCA AND PC-BATCH CORRECTION #
##################################

[1] TRUE
sample.info: 
First 3 records excerpt:
       grp   plate   well phenotype QCfail sex call.rate heterozygosity
ID0001   1 PLT0001 R01C01         1      0   2 0.9998606      0.2421278
ID0002   1 PLT0001 R02C01         1      0   2 0.9998606      0.2275336
ID0003   1 PLT0001 R03C01         1      0   1 1.0000000      0.2207557
snp.info: 
First 3 records excerpt:
RangedData with 3 rows and 4 value columns across 25 spaces
                 space             ranges |     gindx call.rate     P.hwe    QCfail
              <factor>          <IRanges> | <numeric> <numeric> <numeric> <numeric>
imm_1_7722552        1 [7722552, 7722552] |   7722552         1 0.6136694         0
imm_1_7722929        1 [7722929, 7722929] |   7722929         1 0.8748153         0
imm_1_7723190        1 [7723190, 7723190] |   7723190         1 0.6248590         0

Selecting SNP subset for PCA based on a 35% random selection of SNPS
 choosing spaced 35 % subset of SNPs
 selecting only autosomes
snp.info contains data for chromsomes: 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22 
 filtered 10 locations in MHC region
 filtered 1 SNP locations in telomeric,centromeric and immunoglobin regions
 total number of SNPs kept: 1037 [ 6.9 %]
 total of 4299 removed because they did not uniquely map to 1 location
~wrote list of SNPs to use in the PCA to file:
  /Users/ncooper/github/plumbCNV_Example/pipesDisease/ANNOTATION/pca.snp.subset.txt 

Filtering samples/snps with SNP-QC failures:
 attached matrix with dims: 14344,97 
 calculating selections for snps
 selected 97 listed samples and 1037 Snps
 starting deep copy...done
[1] "/Users/ncooper/github/plumbCNV_Example/pipesDisease/BIGMATRICES/PCAMatrixSortdescrFile.RData"

Running Principle Components Analysis (PCA), using LRR-data subset:


Big matrix; 'pcaMat', with: 989 rows, 97 columns
 - data type: numeric 

                   colnames 
Row#      rownames   ID0001   ID0002  .....    ID0100 
   1 imm_1_7768154  -0.0969  -0.1352   ...    -0.0052 
   2     rs3737964  -0.1382   -0.165   ...     0.0687 
   3     rs6675934  -0.2057  -0.2601   ...     0.0393 
  ..          ....      ...      ...   ...        ... 
 989     rs8139123  -0.2366  -0.4045   ...     -0.216 

 centering data by row means... means for first 10 snps:
 imm_1_7768154      rs3737964      rs6675934      rs3121607 imm_1_13815022     rs12754997      rs4661493      rs7546786     rs12562864  vh_1_16072147 
             0              0              0              0              0              0              0              0              0              0 
 replaced missing data with mean (PCA cannot handle missing data)
 PCA by singular value decomposition...took 0 minutes
~wrote PC data to file: /Users/ncooper/github/plumbCNV_Example/pipesDisease/PCA/PCsEVsFromPCA.RData 
 generating scree plots for principal components analyses
 estimate of eigenvalue sum of 77 uncalculated eigenvalues: 78.21233 
 slope [a + bx] : -0.3465326 
~wrote file: /Users/ncooper/github/plumbCNV_Example/pipesDisease/PCA/ScreePlotPCA.pdf 
 78.2 % Est. LRR variance explained by first 12 components.

Running Principle Components correction (PC-correction), using LRR-dataset:

Big matrix; 'origMat', with: 14344 rows, 97 columns
 - data type: numeric 

                    colnames 
 Row#      rownames   ID0001   ID0002  .....    ID0100 
    1 imm_1_7722552  -0.3457  -0.3033   ...    -0.3835 
    2 imm_1_7722929  -0.0482  -0.0999   ...    -0.0683 
    3 imm_1_7723190  -0.0129  -0.0722   ...    -0.0861 
   ..          ....      ...      ...   ...        ... 
14344     rs8139123  -0.2366  -0.4045   ...     -0.216 

 creating new file backed big.matrix to store corrected data...done
 correcting by principle components, taking the regression-residual for each variable
0         25%         50%         75%         100%
..................................................

PC-corrected dataset produced:

Big matrix; 'pcCorMat', with: 14344 rows, 97 columns
 - data type: numeric 

                    colnames 
 Row#      rownames   ID0001   ID0002  .....    ID0100 
    1 imm_1_7722552  -0.0016   0.0313   ...     -0.047 
    2 imm_1_7722929   0.0229  -0.0077   ...    -0.0151 
    3 imm_1_7723190   0.0371  -0.0217   ...    -0.0575 
   ..          ....      ...      ...   ...        ... 
14344     rs8139123   0.0924  -0.1019   ...     0.0434 

~wrote PC-corrected data description file to:
  /Users/ncooper/github/plumbCNV_Example/pipesDisease/BIGMATRICES/describePCcorrect12.RData 

Running analyses to compare pre/post PC distributions (can take a long time)

Calculating sample-wise statistics for LRR
 calculating column means...took 0 seconds
 calculating column SDs...took 0 seconds
 calculating column DLRS (apply method) ...took 0.7 seconds

Adding GC wave to LRR stats, be aware this can be slow
 doing median calculation
0         25%         50%         75%         100%
..................................................
 took 0 hours
 calculating Diskin constants...
~wrote boxplot:
  /Users/ncooper/github/plumbCNV_Example/pipesDisease/SAMPLEQC/MEAN_DLRS_GC/PostPCDistributionsBoxPlot.pdf 
~wrote table
 /Users/ncooper/github/plumbCNV_Example/pipesDisease/SAMPLEQC/MEAN_DLRS_GC/PostPCStatsPerSample.tab 


Cohort distribution statistics for LRR-stats:
            Mean     DLRS    GCWave
   Mean        0   0.0663    -1e-04
     SD   0.0031   0.0051    0.0093
    Min  -0.0076   0.0564   -0.0116
     Q1  -0.0018   0.0626   -0.0091
 Median        0   0.0655   -0.0076
     Q3   0.0017   0.0697    0.0089
    Max   0.0085   0.0815    0.0147
     LB  -0.0071    0.052   -0.0361
     UB    0.007   0.0803     0.036
   -2SD  -0.0062   0.0562   -0.0188
   +2SD   0.0062   0.0764    0.0185
   -3SD  -0.0092   0.0511   -0.0282
   +3SD   0.0092   0.0815    0.0279
  Low1%  -0.0076   0.0564   -0.0115
   Hi1%   0.0069   0.0787    0.0115

~wrote plots to: /Users/ncooper/github/plumbCNV_Example/pipesDisease/PCA/ThreeStageComparisonplate.pdf 

####################################
# 5. RUN CNV CALLING WITH PENN-CNV #
####################################


Preparing for the running of PennCNV.
 deleting old penn-cnv raw subject files from:
 /Users/ncooper/github/plumbCNV_Example/pipesDisease/PENNCNV/PENNRAWFILES/ 

Preparing input files for PENN-CNV from LRR and BAF
 using LRR big.matrix file: /Users/ncooper/github/plumbCNV_Example/pipesDisease/BIGMATRICES/describePCcorrect12.RData 
 using BAF big.matrix file: /Users/ncooper/github/plumbCNV_Example/pipesDisease/BIGMATRICES/BAF.RData 
Big matrix with: 15338 rows, 100 columns
 - data type: numeric 

                     colnames 
 Row#       rownames   ID0001   ID0002  .....    ID0100 
    1 chr1_171422483        1   0.9941   ...          1 
    2 chr11_76048775        0        0   ...     0.0022 
    3 chr11_76048907        1        1   ...          1 
   ..           ....      ...      ...   ...        ... 
15338  vh_X_48999118   0.0029        0   ...          0 

Big matrix with: 14344 rows, 97 columns
 - data type: numeric 

                    colnames 
 Row#      rownames   ID0001   ID0002  .....    ID0100 
    1 imm_1_7722552  -0.0016   0.0313   ...     -0.047 
    2 imm_1_7722929   0.0229  -0.0077   ...    -0.0151 
    3 imm_1_7723190   0.0371  -0.0217   ...    -0.0575 
   ..          ....      ...      ...   ...        ... 
14344     rs8139123   0.0924  -0.1019   ...     0.0434 


Will create 3 penn folders with sizes: 33,32,32 
97 cols from LRR in BAF
14344 rows from LRR in BAF
 BAF missing 0 samples in LRR file
 BAF missing 0 snps in LRR file
 generating individual sample LRR/BAF files in Penn-CNV format:
minutes remaining: 0..0..0..0..0..0..0..0..0..0..0..0..0..0..0..0..

~wrote 3 PennCNV sample selection files to:
  /Users/ncooper/github/plumbCNV_Example/pipesDisease/PENNCNV/PENNRAWFILES/ 
 number of samples written per PENN-CNV directory: 33,32,32 

Generate GC percentage for SNPs
 using build hg18 and chromosomes 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22 
 loaded marker-GC from file (current snp list seemed to exactly matched stored result)
 0 zero GC values set to missing (NA)
~wrote SNP GC averages to file:
  /Users/ncooper/github/plumbCNV_Example/pipesDisease/PENNCNV/marker.gcm 

Regenerating BAF average data from BAF matrix
0         25%         50%         75%         100%
..................................................
~wrote file baf means for each SNP to file:
  /Users/ncooper/github/plumbCNV_Example/pipesDisease/PENNCNV/BAF.pfb 
 deleting old penn-cnv output files from:
 /Users/ncooper/github/plumbCNV_Example/pipesDisease/PENNCNV/PENNOUTPUT/ 

Running the PennCNV (hidden markov model for CNV calling)
 using the hmm file:  hh550.hmm 

~wrote 3 PennCNV sample selection files to:
  /Users/ncooper/github/plumbCNV_Example/pipesDisease/PENNCNV/PENNRAWFILES/ 

 parallel PennCNV processing for 3 files initiated: 1..2..3..
 expect processing to take roughly 0.17hrs ... parallel PennCNV took 0 minutes

#########################
# 6. CNV QC AND SUMMARY #
#########################

Running CNV-QC on processed PennCNV files
 phenotypes found in annotation file:
pheno
 1  2 
43 54 
~wrote fam file: /Users/ncooper/github/plumbCNV_Example/pipesDisease/CNVQC/plink.fam 
NOTICE: Total of 14344 records are read from /Users/ncooper/github/plumbCNV_Example/pipesDisease/PENNCNV/BAF.pfb
NOTICE: Total of 14344 records are read from /Users/ncooper/github/plumbCNV_Example/pipesDisease/PENNCNV/BAF.pfb
 merging adjacent cnvs with <20% gaps between them ('clean_cnv.pl combineseg')..
 removing CNVs with >50% overlap with immunoglobin, telomeric and centromeric regions
~wrote file cnvs_in_badRegions.txt.tmp with unwanted path text removed
. done
plink.out: plink.cnv (character, 1)
~wrote file plink.cnv with unwanted path text removed

@----------------------------------------------------------@
|        PLINK!       |     v1.07      |   10/Aug/2009     |
|----------------------------------------------------------|
|  (C) 2009 Shaun Purcell, GNU General Public License, v2  |
|----------------------------------------------------------|
|  For documentation, citation & bug-report instructions:  |
|        http://pngu.mgh.harvard.edu/purcell/plink/        |
@----------------------------------------------------------@

Web-based version check ( --noweb to skip )
Recent cached web-check found...Problem connecting to web

Writing this text to log file [ plink.log ]
Analysis started: Tue Apr  9 23:02:12 2019

Options in effect:
	--cnv-list plink.cnv
	--cnv-make-map
	--out plink


Reading segment list (CNVs) from [ plink.cnv ]
Writing new MAP file to [ plink.cnv.map ]
Wrote 12 unique positions to file

Analysis finished: Tue Apr  9 23:02:12 2019


@----------------------------------------------------------@
|        PLINK!       |     v1.07      |   10/Aug/2009     |
|----------------------------------------------------------|
|  (C) 2009 Shaun Purcell, GNU General Public License, v2  |
|----------------------------------------------------------|
|  For documentation, citation & bug-report instructions:  |
|        http://pngu.mgh.harvard.edu/purcell/plink/        |
@----------------------------------------------------------@

Web-based version check ( --noweb to skip )
Recent cached web-check found...Problem connecting to web

Writing this text to log file [ plink.log ]
Analysis started: Tue Apr  9 23:02:12 2019

Options in effect:
	--cfile plink
	--cnv-check-no-overlap
	--allow-no-sex

Reading marker information from [ plink.cnv.map ]
12 (of 12) markers to be included from [ plink.cnv.map ]
Reading individual information from [ plink.fam ]
Reading pedigree information from [ plink.fam ] 
97 individuals read from [ plink.fam ] 
97 individuals with nonmissing phenotypes
Assuming a disease phenotype (1=unaff, 2=aff, 0=miss)
Missing phenotype value is also -9
54 cases, 43 controls and 0 missing
50 males, 47 females, and 0 of unspecified sex

Reading segment list (CNVs) from [ plink.cnv ]
No overlapping samples found
4 mapped to a person, of which 4 passed filters
4 of 4 mapped as valid segments
 CopyN Case/Control
     0        1 / 0
     1        0 / 2
     4        0 / 1

Writing per-individual summary to [ plink.cnv.indiv ]
Writing positional summary to [ plink.cnv.summary ]

Analysis finished: Tue Apr  9 23:02:12 2019


Filtering samples with a large number of CNVs

 distribution: mean=1, SD=0   ==>   threshold=1   [mean + 3.5*sd]

CNV length stats  
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
   3673    5926   13830   17560   25470   38900 

$`length >0 and <=1kb`
[1] 0

$`length >1kb and <=10kb`
[1] 2

$`length >10kb and <=50kb`
[1] 2

$`length >50kb and <=100kb`
[1] 0

$`length >100kb and <=500kb`
[1] 0

$`length >500kb and <=5mb`
[1] 0

$`length >5mb `
[1] 0


30 highest CNV samples  
     SampleIDs CNVs
[1,] "ID0015"  "1" 
[2,] "ID0028"  "1" 
[3,] "ID0054"  "1" 
[4,] "ID0073"  "1" 

HISTO of CNVs per sample  
 using halved %'s as maximum freq is too big for terminal
0   .................................................. 
NULL

 list of 0 samples with too many CNVs from plink.cnv :
character(0)

 no samples removed from:
  /Users/ncooper/github/plumbCNV_Example/pipesDisease/CNVQC/plink.cnv 
 no samples removed from:
  /Users/ncooper/github/plumbCNV_Example/pipesDisease/CNVQC/plink.fam 
 no samples removed from:
  /Users/ncooper/github/plumbCNV_Example/pipesDisease/CNVQC/plink.cnv.map 
 done

@----------------------------------------------------------@
|        PLINK!       |     v1.07      |   10/Aug/2009     |
|----------------------------------------------------------|
|  (C) 2009 Shaun Purcell, GNU General Public License, v2  |
|----------------------------------------------------------|
|  For documentation, citation & bug-report instructions:  |
|        http://pngu.mgh.harvard.edu/purcell/plink/        |
@----------------------------------------------------------@

Web-based version check ( --noweb to skip )
Recent cached web-check found...Problem connecting to web

Writing this text to log file [ rareDEL.log ]
Analysis started: Tue Apr  9 23:02:12 2019

Options in effect:
	--cfile plink_CNVcnt
	--cnv-del
	--cnv-sites 6
	--cnv-drop-no-segment
	--cnv-freq-exclude-above 5
	--cnv-overlap 0.5
	--cnv-write
	--out rareDEL
	--allow-no-sex

Reading marker information from [ plink_CNVcnt.cnv.map ]
12 (of 12) markers to be included from [ plink_CNVcnt.cnv.map ]
Reading individual information from [ plink_CNVcnt.fam ]
Reading pedigree information from [ plink_CNVcnt.fam ] 
97 individuals read from [ plink_CNVcnt.fam ] 
97 individuals with nonmissing phenotypes
Assuming a disease phenotype (1=unaff, 2=aff, 0=miss)
Missing phenotype value is also -9
54 cases, 43 controls and 0 missing
50 males, 47 females, and 0 of unspecified sex

Reading segment list (CNVs) from [ plink_CNVcnt.cnv ]
Filtering segments based on frequencies
Will remove 0 CNVs based on frequency (after other filters)
Removed 94 individuals with <1 CNV
4 mapped to a person, of which 3 passed filters
3 of 4 mapped as valid segments
 CopyN Case/Control
     0        1 / 0
     1        0 / 2

Writing new CNV list to [ rareDEL.cnv ]
Writing new FAM file to [ rareDEL.fam ]

Analysis finished: Tue Apr  9 23:02:12 2019


@----------------------------------------------------------@
|        PLINK!       |     v1.07      |   10/Aug/2009     |
|----------------------------------------------------------|
|  (C) 2009 Shaun Purcell, GNU General Public License, v2  |
|----------------------------------------------------------|
|  For documentation, citation & bug-report instructions:  |
|        http://pngu.mgh.harvard.edu/purcell/plink/        |
@----------------------------------------------------------@

Web-based version check ( --noweb to skip )
Recent cached web-check found...Problem connecting to web

Writing this text to log file [ rareDUP.log ]
Analysis started: Tue Apr  9 23:02:12 2019

Options in effect:
	--cfile plink_CNVcnt
	--cnv-dup
	--cnv-sites 6
	--cnv-drop-no-segment
	--cnv-freq-exclude-above 5
	--cnv-overlap 0.5
	--cnv-write
	--out rareDUP
	--allow-no-sex

Reading marker information from [ plink_CNVcnt.cnv.map ]
12 (of 12) markers to be included from [ plink_CNVcnt.cnv.map ]
Reading individual information from [ plink_CNVcnt.fam ]
Reading pedigree information from [ plink_CNVcnt.fam ] 
97 individuals read from [ plink_CNVcnt.fam ] 
97 individuals with nonmissing phenotypes
Assuming a disease phenotype (1=unaff, 2=aff, 0=miss)
Missing phenotype value is also -9
54 cases, 43 controls and 0 missing
50 males, 47 females, and 0 of unspecified sex

Reading segment list (CNVs) from [ plink_CNVcnt.cnv ]
Filtering segments based on frequencies
Will remove 0 CNVs based on frequency (after other filters)
Removed 96 individuals with <1 CNV
4 mapped to a person, of which 1 passed filters
1 of 4 mapped as valid segments
 CopyN Case/Control
     4        0 / 1

Writing new CNV list to [ rareDUP.cnv ]
Writing new FAM file to [ rareDUP.fam ]

Analysis finished: Tue Apr  9 23:02:12 2019


Filtering samples with a large number of rareDUPs
 cutoff for duplicates: 4; p<0.01, X~poisson(0.75)

CNV length stats [DUPs] 
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
   3673    3673    3673    3673    3673    3673 

$`length >0 and <=1kb`
[1] 0

$`length >1kb and <=10kb`
[1] 1

$`length >10kb and <=50kb`
[1] 0

$`length >50kb and <=100kb`
[1] 0

$`length >100kb and <=500kb`
[1] 0

$`length >500kb and <=5mb`
[1] 0

$`length >5mb `
[1] 0


30 highest CNV samples [DUPs] 
     SampleIDs CNVs
[1,] "ID0015"  "1" 

HISTO of CNVs per sample [DUPs] 

 list of 0 samples with too many CNVs from rareDUP :
character(0)

 no samples removed from:
  /Users/ncooper/github/plumbCNV_Example/pipesDisease/CNVQC/plink_CNVcnt.cnv 
 no samples removed from:
  /Users/ncooper/github/plumbCNV_Example/pipesDisease/CNVQC/plink_CNVcnt.fam 
 no samples removed from:
  /Users/ncooper/github/plumbCNV_Example/pipesDisease/CNVQC/plink_CNVcnt.cnv.map 
 done

Filtering samples with a large number of rareDELs
 cutoff for deletions: 4; p<0.01, X~poisson(0.6)

CNV length stats [DELs] 
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
   6677   13830   20990   22190   29940   38900 

$`length >0 and <=1kb`
[1] 0

$`length >1kb and <=10kb`
[1] 1

$`length >10kb and <=50kb`
[1] 2

$`length >50kb and <=100kb`
[1] 0

$`length >100kb and <=500kb`
[1] 0

$`length >500kb and <=5mb`
[1] 0

$`length >5mb `
[1] 0


30 highest CNV samples [DELs] 
     SampleIDs CNVs
[1,] "ID0028"  "1" 
[2,] "ID0054"  "1" 
[3,] "ID0073"  "1" 

HISTO of CNVs per sample [DELs] 
 using halved %'s as maximum freq is too big for terminal
0   .................................................. 
NULL

 list of 0 samples with too many CNVs from rareDEL :
character(0)

 no samples removed from:
  /Users/ncooper/github/plumbCNV_Example/pipesDisease/CNVQC/plink_CNVcnt_DUPrcnt.cnv 
 no samples removed from:
  /Users/ncooper/github/plumbCNV_Example/pipesDisease/CNVQC/plink_CNVcnt_DUPrcnt.fam 
 no samples removed from:
  /Users/ncooper/github/plumbCNV_Example/pipesDisease/CNVQC/plink_CNVcnt_DUPrcnt.cnv.map 
 done

Filtering samples from plates with a large number of CNVs per sample

Plates with too many CNVs (oversensitive)
[none exceeded boundary]

Plates with too few CNVs (undersensitive)
[none exceeded boundary]

 list of 0 samples from plates with too many CNVs from plink_CNVcnt_DUPrcnt_DELrcnt.cnv :
character(0)

 samples from plates with too few noted but left in the dataset

 no samples removed from:
  /Users/ncooper/github/plumbCNV_Example/pipesDisease/CNVQC/plink_CNVcnt_DUPrcnt_DELrcnt.cnv 
 no samples removed from:
  /Users/ncooper/github/plumbCNV_Example/pipesDisease/CNVQC/plink_CNVcnt_DUPrcnt_DELrcnt.fam 
 no samples removed from:
  /Users/ncooper/github/plumbCNV_Example/pipesDisease/CNVQC/plink_CNVcnt_DUPrcnt_DELrcnt.cnv.map 
 done

Filtering samples from plates with a large number of rare CNVs per sample
[NB: tagged plates may be same as filtered above for all CNVs]

Plates with too many CNVs (oversensitive)
[none exceeded boundary]

Plates with too few CNVs (undersensitive)
[none exceeded boundary]

 list of 0 samples from plates with too many CNVs from rareDEL,rareDUP :
character(0)

 samples from plates with too few noted but left in the dataset

 no samples removed from:
  /Users/ncooper/github/plumbCNV_Example/pipesDisease/CNVQC/plink_CNVcnt_DUPrcnt_DELrcnt_PLATEcnt.cnv 
 no samples removed from:
  /Users/ncooper/github/plumbCNV_Example/pipesDisease/CNVQC/plink_CNVcnt_DUPrcnt_DELrcnt_PLATEcnt.fam 
 no samples removed from:
  /Users/ncooper/github/plumbCNV_Example/pipesDisease/CNVQC/plink_CNVcnt_DUPrcnt_DELrcnt_PLATEcnt.cnv.map 
 done

@----------------------------------------------------------@
|        PLINK!       |     v1.07      |   10/Aug/2009     |
|----------------------------------------------------------|
|  (C) 2009 Shaun Purcell, GNU General Public License, v2  |
|----------------------------------------------------------|
|  For documentation, citation & bug-report instructions:  |
|        http://pngu.mgh.harvard.edu/purcell/plink/        |
@----------------------------------------------------------@

Web-based version check ( --noweb to skip )
Recent cached web-check found...Problem connecting to web

Writing this text to log file [ allCNV.log ]
Analysis started: Tue Apr  9 23:02:12 2019

Options in effect:
	--cfile plink_CNVcnt_DUPrcnt_DELrcnt_PLATEcnt_PLATErcnt
	--cnv-drop-no-segment
	--cnv-write
	--out allCNV
	--allow-no-sex

Reading marker information from [ plink_CNVcnt_DUPrcnt_DELrcnt_PLATEcnt_PLATErcnt.cnv.map ]
12 (of 12) markers to be included from [ plink_CNVcnt_DUPrcnt_DELrcnt_PLATEcnt_PLATErcnt.cnv.map ]
Reading individual information from [ plink_CNVcnt_DUPrcnt_DELrcnt_PLATEcnt_PLATErcnt.fam ]
Reading pedigree information from [ plink_CNVcnt_DUPrcnt_DELrcnt_PLATEcnt_PLATErcnt.fam ] 
97 individuals read from [ plink_CNVcnt_DUPrcnt_DELrcnt_PLATEcnt_PLATErcnt.fam ] 
97 individuals with nonmissing phenotypes
Assuming a disease phenotype (1=unaff, 2=aff, 0=miss)
Missing phenotype value is also -9
54 cases, 43 controls and 0 missing
50 males, 47 females, and 0 of unspecified sex

Reading segment list (CNVs) from [ plink_CNVcnt_DUPrcnt_DELrcnt_PLATEcnt_PLATErcnt.cnv ]
Removed 93 individuals with <1 CNV
4 mapped to a person, of which 4 passed filters
4 of 4 mapped as valid segments
 CopyN Case/Control
     0        1 / 0
     1        0 / 2
     4        0 / 1

Writing new CNV list to [ allCNV.cnv ]
Writing new FAM file to [ allCNV.fam ]

Analysis finished: Tue Apr  9 23:02:12 2019


@----------------------------------------------------------@
|        PLINK!       |     v1.07      |   10/Aug/2009     |
|----------------------------------------------------------|
|  (C) 2009 Shaun Purcell, GNU General Public License, v2  |
|----------------------------------------------------------|
|  For documentation, citation & bug-report instructions:  |
|        http://pngu.mgh.harvard.edu/purcell/plink/        |
@----------------------------------------------------------@

Web-based version check ( --noweb to skip )
Recent cached web-check found...Problem connecting to web

Writing this text to log file [ allCNV.log ]
Analysis started: Tue Apr  9 23:02:13 2019

Options in effect:
	--cnv-list allCNV.cnv
	--cnv-make-map
	--out allCNV


Reading segment list (CNVs) from [ allCNV.cnv ]
Writing new MAP file to [ allCNV.cnv.map ]
Wrote 12 unique positions to file

Analysis finished: Tue Apr  9 23:02:13 2019


@----------------------------------------------------------@
|        PLINK!       |     v1.07      |   10/Aug/2009     |
|----------------------------------------------------------|
|  (C) 2009 Shaun Purcell, GNU General Public License, v2  |
|----------------------------------------------------------|
|  For documentation, citation & bug-report instructions:  |
|        http://pngu.mgh.harvard.edu/purcell/plink/        |
@----------------------------------------------------------@

Web-based version check ( --noweb to skip )
Recent cached web-check found...Problem connecting to web

Writing this text to log file [ allDel.log ]
Analysis started: Tue Apr  9 23:02:13 2019

Options in effect:
	--cfile allCNV
	--cnv-del
	--cnv-drop-no-segment
	--cnv-write
	--out allDel
	--allow-no-sex

Reading marker information from [ allCNV.cnv.map ]
12 (of 12) markers to be included from [ allCNV.cnv.map ]
Reading individual information from [ allCNV.fam ]
Reading pedigree information from [ allCNV.fam ] 
4 individuals read from [ allCNV.fam ] 
4 individuals with nonmissing phenotypes
Assuming a disease phenotype (1=unaff, 2=aff, 0=miss)
Missing phenotype value is also -9
1 cases, 3 controls and 0 missing
2 males, 2 females, and 0 of unspecified sex

Reading segment list (CNVs) from [ allCNV.cnv ]
Removed 1 individuals with <1 CNV
4 mapped to a person, of which 3 passed filters
3 of 4 mapped as valid segments
 CopyN Case/Control
     0        1 / 0
     1        0 / 2

Writing new CNV list to [ allDel.cnv ]
Writing new FAM file to [ allDel.fam ]

Analysis finished: Tue Apr  9 23:02:13 2019


@----------------------------------------------------------@
|        PLINK!       |     v1.07      |   10/Aug/2009     |
|----------------------------------------------------------|
|  (C) 2009 Shaun Purcell, GNU General Public License, v2  |
|----------------------------------------------------------|
|  For documentation, citation & bug-report instructions:  |
|        http://pngu.mgh.harvard.edu/purcell/plink/        |
@----------------------------------------------------------@

Web-based version check ( --noweb to skip )
Recent cached web-check found...Problem connecting to web

Writing this text to log file [ allDup.log ]
Analysis started: Tue Apr  9 23:02:13 2019

Options in effect:
	--cfile allCNV
	--cnv-dup
	--cnv-drop-no-segment
	--cnv-write
	--out allDup
	--allow-no-sex

Reading marker information from [ allCNV.cnv.map ]
12 (of 12) markers to be included from [ allCNV.cnv.map ]
Reading individual information from [ allCNV.fam ]
Reading pedigree information from [ allCNV.fam ] 
4 individuals read from [ allCNV.fam ] 
4 individuals with nonmissing phenotypes
Assuming a disease phenotype (1=unaff, 2=aff, 0=miss)
Missing phenotype value is also -9
1 cases, 3 controls and 0 missing
2 males, 2 females, and 0 of unspecified sex

Reading segment list (CNVs) from [ allCNV.cnv ]
Removed 3 individuals with <1 CNV
4 mapped to a person, of which 1 passed filters
1 of 4 mapped as valid segments
 CopyN Case/Control
     4        0 / 1

Writing new CNV list to [ allDup.cnv ]
Writing new FAM file to [ allDup.fam ]

Analysis finished: Tue Apr  9 23:02:13 2019


@----------------------------------------------------------@
|        PLINK!       |     v1.07      |   10/Aug/2009     |
|----------------------------------------------------------|
|  (C) 2009 Shaun Purcell, GNU General Public License, v2  |
|----------------------------------------------------------|
|  For documentation, citation & bug-report instructions:  |
|        http://pngu.mgh.harvard.edu/purcell/plink/        |
@----------------------------------------------------------@

Web-based version check ( --noweb to skip )
Recent cached web-check found...Problem connecting to web

Writing this text to log file [ rareDUP.log ]
Analysis started: Tue Apr  9 23:02:13 2019

Options in effect:
	--cfile allCNV
	--cnv-dup
	--cnv-sites 6
	--cnv-drop-no-segment
	--cnv-freq-exclude-above 5
	--cnv-overlap 0.5
	--cnv-write
	--out rareDUP
	--allow-no-sex

Reading marker information from [ allCNV.cnv.map ]
12 (of 12) markers to be included from [ allCNV.cnv.map ]
Reading individual information from [ allCNV.fam ]
Reading pedigree information from [ allCNV.fam ] 
4 individuals read from [ allCNV.fam ] 
4 individuals with nonmissing phenotypes
Assuming a disease phenotype (1=unaff, 2=aff, 0=miss)
Missing phenotype value is also -9
1 cases, 3 controls and 0 missing
2 males, 2 females, and 0 of unspecified sex

Reading segment list (CNVs) from [ allCNV.cnv ]
Filtering segments based on frequencies
Will remove 0 CNVs based on frequency (after other filters)
Removed 3 individuals with <1 CNV
4 mapped to a person, of which 1 passed filters
1 of 4 mapped as valid segments
 CopyN Case/Control
     4        0 / 1

Writing new CNV list to [ rareDUP.cnv ]
Writing new FAM file to [ rareDUP.fam ]

Analysis finished: Tue Apr  9 23:02:13 2019


@----------------------------------------------------------@
|        PLINK!       |     v1.07      |   10/Aug/2009     |
|----------------------------------------------------------|
|  (C) 2009 Shaun Purcell, GNU General Public License, v2  |
|----------------------------------------------------------|
|  For documentation, citation & bug-report instructions:  |
|        http://pngu.mgh.harvard.edu/purcell/plink/        |
@----------------------------------------------------------@

Web-based version check ( --noweb to skip )
Recent cached web-check found...Problem connecting to web

Writing this text to log file [ rareDEL.log ]
Analysis started: Tue Apr  9 23:02:13 2019

Options in effect:
	--cnv-list rareDEL.cnv
	--cnv-make-map
	--out rareDEL


Reading segment list (CNVs) from [ rareDEL.cnv ]
Writing new MAP file to [ rareDEL.cnv.map ]
Wrote 9 unique positions to file

Analysis finished: Tue Apr  9 23:02:13 2019


@----------------------------------------------------------@
|        PLINK!       |     v1.07      |   10/Aug/2009     |
|----------------------------------------------------------|
|  (C) 2009 Shaun Purcell, GNU General Public License, v2  |
|----------------------------------------------------------|
|  For documentation, citation & bug-report instructions:  |
|        http://pngu.mgh.harvard.edu/purcell/plink/        |
@----------------------------------------------------------@

Web-based version check ( --noweb to skip )
Recent cached web-check found...Problem connecting to web

Writing this text to log file [ rareDUP.log ]
Analysis started: Tue Apr  9 23:02:13 2019

Options in effect:
	--cnv-list rareDUP.cnv
	--cnv-make-map
	--out rareDUP


Reading segment list (CNVs) from [ rareDUP.cnv ]
Writing new MAP file to [ rareDUP.cnv.map ]
Wrote 3 unique positions to file

Analysis finished: Tue Apr  9 23:02:13 2019


@----------------------------------------------------------@
|        PLINK!       |     v1.07      |   10/Aug/2009     |
|----------------------------------------------------------|
|  (C) 2009 Shaun Purcell, GNU General Public License, v2  |
|----------------------------------------------------------|
|  For documentation, citation & bug-report instructions:  |
|        http://pngu.mgh.harvard.edu/purcell/plink/        |
@----------------------------------------------------------@

Web-based version check ( --noweb to skip )
Recent cached web-check found...Problem connecting to web

Writing this text to log file [ rareDEL.log ]
Analysis started: Tue Apr  9 23:02:13 2019

Options in effect:
	--cfile allCNV
	--cnv-del
	--cnv-sites 6
	--cnv-drop-no-segment
	--cnv-freq-exclude-above 5
	--cnv-overlap 0.5
	--cnv-write
	--out rareDEL
	--allow-no-sex

Reading marker information from [ allCNV.cnv.map ]
12 (of 12) markers to be included from [ allCNV.cnv.map ]
Reading individual information from [ allCNV.fam ]
Reading pedigree information from [ allCNV.fam ] 
4 individuals read from [ allCNV.fam ] 
4 individuals with nonmissing phenotypes
Assuming a disease phenotype (1=unaff, 2=aff, 0=miss)
Missing phenotype value is also -9
1 cases, 3 controls and 0 missing
2 males, 2 females, and 0 of unspecified sex

Reading segment list (CNVs) from [ allCNV.cnv ]
Filtering segments based on frequencies
Will remove 0 CNVs based on frequency (after other filters)
Removed 1 individuals with <1 CNV
4 mapped to a person, of which 3 passed filters
3 of 4 mapped as valid segments
 CopyN Case/Control
     0        1 / 0
     1        0 / 2

Writing new CNV list to [ rareDEL.cnv ]
Writing new FAM file to [ rareDEL.fam ]

Analysis finished: Tue Apr  9 23:02:13 2019


@----------------------------------------------------------@
|        PLINK!       |     v1.07      |   10/Aug/2009     |
|----------------------------------------------------------|
|  (C) 2009 Shaun Purcell, GNU General Public License, v2  |
|----------------------------------------------------------|
|  For documentation, citation & bug-report instructions:  |
|        http://pngu.mgh.harvard.edu/purcell/plink/        |
@----------------------------------------------------------@

Web-based version check ( --noweb to skip )
Recent cached web-check found...Problem connecting to web

Writing this text to log file [ rareDEL.log ]
Analysis started: Tue Apr  9 23:02:13 2019

Options in effect:
	--cfile rareDEL
	--cnv-seglist
	--out rareDEL
	--allow-no-sex

Reading marker information from [ rareDEL.cnv.map ]
9 (of 9) markers to be included from [ rareDEL.cnv.map ]
Reading individual information from [ rareDEL.fam ]
Reading pedigree information from [ rareDEL.fam ] 
3 individuals read from [ rareDEL.fam ] 
3 individuals with nonmissing phenotypes
Assuming a disease phenotype (1=unaff, 2=aff, 0=miss)
Missing phenotype value is also -9
1 cases, 2 controls and 0 missing
1 males, 2 females, and 0 of unspecified sex

Reading segment list (CNVs) from [ rareDEL.cnv ]
3 mapped to a person, of which 3 passed filters
3 of 3 mapped as valid segments
 CopyN Case/Control
     0        1 / 0
     1        0 / 2

Writing per-individual summary to [ rareDEL.cnv.indiv ]
Writing long-format segment list to [ rareDEL.cnv.seglist ]
Writing positional summary to [ rareDEL.cnv.summary ]

Analysis finished: Tue Apr  9 23:02:13 2019


@----------------------------------------------------------@
|        PLINK!       |     v1.07      |   10/Aug/2009     |
|----------------------------------------------------------|
|  (C) 2009 Shaun Purcell, GNU General Public License, v2  |
|----------------------------------------------------------|
|  For documentation, citation & bug-report instructions:  |
|        http://pngu.mgh.harvard.edu/purcell/plink/        |
@----------------------------------------------------------@

Web-based version check ( --noweb to skip )
Recent cached web-check found...Problem connecting to web

Writing this text to log file [ rareDUP.log ]
Analysis started: Tue Apr  9 23:02:13 2019

Options in effect:
	--cfile rareDUP
	--cnv-seglist
	--out rareDUP
	--allow-no-sex

Reading marker information from [ rareDUP.cnv.map ]
3 (of 3) markers to be included from [ rareDUP.cnv.map ]
Reading individual information from [ rareDUP.fam ]
Reading pedigree information from [ rareDUP.fam ] 
1 individuals read from [ rareDUP.fam ] 
1 individuals with nonmissing phenotypes
Assuming a disease phenotype (1=unaff, 2=aff, 0=miss)
Missing phenotype value is also -9
0 cases, 1 controls and 0 missing
1 males, 0 females, and 0 of unspecified sex

Reading segment list (CNVs) from [ rareDUP.cnv ]
1 mapped to a person, of which 1 passed filters
1 of 1 mapped as valid segments
 CopyN Case/Control
     4        0 / 1

Writing per-individual summary to [ rareDUP.cnv.indiv ]
Writing long-format segment list to [ rareDUP.cnv.seglist ]
Writing positional summary to [ rareDUP.cnv.summary ]

Analysis finished: Tue Apr  9 23:02:13 2019


@----------------------------------------------------------@
|        PLINK!       |     v1.07      |   10/Aug/2009     |
|----------------------------------------------------------|
|  (C) 2009 Shaun Purcell, GNU General Public License, v2  |
|----------------------------------------------------------|
|  For documentation, citation & bug-report instructions:  |
|        http://pngu.mgh.harvard.edu/purcell/plink/        |
@----------------------------------------------------------@

Web-based version check ( --noweb to skip )
Recent cached web-check found...Problem connecting to web

Writing this text to log file [ rareDEL.log ]
Analysis started: Tue Apr  9 23:02:13 2019

Options in effect:
	--cfile rareDEL
	--segment-group
	--out rareDEL
	--cnv-overlap 0.5
	--allow-no-sex

Reading marker information from [ rareDEL.cnv.map ]
9 (of 9) markers to be included from [ rareDEL.cnv.map ]
Reading individual information from [ rareDEL.fam ]
Reading pedigree information from [ rareDEL.fam ] 
3 individuals read from [ rareDEL.fam ] 
3 individuals with nonmissing phenotypes
Assuming a disease phenotype (1=unaff, 2=aff, 0=miss)
Missing phenotype value is also -9
1 cases, 2 controls and 0 missing
1 males, 2 females, and 0 of unspecified sex

Reading segment list (CNVs) from [ rareDEL.cnv ]
3 mapped to a person, of which 3 passed filters
3 of 3 mapped as valid segments
 CopyN Case/Control
     0        1 / 0
     1        0 / 2

Writing per-individual summary to [ rareDEL.cnv.indiv ]
Writing CNV summary to [ rareDEL.cnv.overlap ] 
Considering position 9 of 9        
Found 0 unique overlapping sets of segments

Writing positional summary to [ rareDEL.cnv.summary ]

Analysis finished: Tue Apr  9 23:02:13 2019


@----------------------------------------------------------@
|        PLINK!       |     v1.07      |   10/Aug/2009     |
|----------------------------------------------------------|
|  (C) 2009 Shaun Purcell, GNU General Public License, v2  |
|----------------------------------------------------------|
|  For documentation, citation & bug-report instructions:  |
|        http://pngu.mgh.harvard.edu/purcell/plink/        |
@----------------------------------------------------------@

Web-based version check ( --noweb to skip )
Recent cached web-check found...Problem connecting to web

Writing this text to log file [ rareDUP.log ]
Analysis started: Tue Apr  9 23:02:14 2019

Options in effect:
	--cfile rareDUP
	--segment-group
	--out rareDUP
	--cnv-overlap 0.5
	--allow-no-sex

Reading marker information from [ rareDUP.cnv.map ]
3 (of 3) markers to be included from [ rareDUP.cnv.map ]
Reading individual information from [ rareDUP.fam ]
Reading pedigree information from [ rareDUP.fam ] 
1 individuals read from [ rareDUP.fam ] 
1 individuals with nonmissing phenotypes
Assuming a disease phenotype (1=unaff, 2=aff, 0=miss)
Missing phenotype value is also -9
0 cases, 1 controls and 0 missing
1 males, 0 females, and 0 of unspecified sex

Reading segment list (CNVs) from [ rareDUP.cnv ]
1 mapped to a person, of which 1 passed filters
1 of 1 mapped as valid segments
 CopyN Case/Control
     4        0 / 1

Writing per-individual summary to [ rareDUP.cnv.indiv ]
Writing CNV summary to [ rareDUP.cnv.overlap ] 
Considering position 3 of 3        
Found 0 unique overlapping sets of segments

Writing positional summary to [ rareDUP.cnv.summary ]

Analysis finished: Tue Apr  9 23:02:14 2019


CNV-QC complete
~wrote CNVs as Ranges object, saved to:
  /Users/ncooper/github/plumbCNV_Example/pipesDisease/RESULTS/112.RData 

=== SNP SUMMARY ===
15338 SNPs in starting dataset
686 SNPs failed SNP-QC
14344 SNPs passed QC

=== SAMPLE SUMMARY ===
100 samples in starting dataset
3 samples failed due to other criteria
97 samples passed QC

=== COHORT SUMMARY ===
      gr
pf     grp 1
  pass    97
  fail     3
3% failed in grp=1

=== PHENOTYPE SUMMARY ===
      ph
pf     pheno 1 pheno 2
  pass      43      54
  fail       3       0

6.52% failed in phenotype=1
0% failed in phenotype=2
4 samples had at least one CNV


plumbCNV pipeline complete
 Resulting *.cnv files: allCNV, allDel, allDup, rareDEL, rareDUP contain, respectively:
   all CNVs, all deletions, all duplications, rare deletions, rare duplications. 
 These files can be processed and analysed using plink. 
 Subfolders of the working plumbCNV directory now contain:
   datasets, annotation, plots, tables, generated during intermediate steps.
 The list object returned by plumbCNV() contains: 
   the same CNVs lists as above (in RangedData objects), overlap summaries, CNV-ratios by 
   phenotype, CNV-regions with Fishers exact tests [or TDT test for family data]. 
 These can be further explored using R packages such as:
   cnvGSA (association tests), genoset (using the saved RangedData objects, plumbCNV LRR/BAF
   plotting functions and bioconductor overlap functions, etc).
 Thankyou for using plumbCNV.


================
= CNVs called: =
================

cnvResult (list, c(4, 6); c(3, 6); c(1, 6); c(3, 6); c(1, 6) )
$allCNV:
RangedData with 4 rows and 6 value columns across 3 spaces
     space                 ranges |          id        cn   numSnps       fid     score phenotype
  <factor>              <IRanges> | <character> <integer> <integer> <integer> <integer> <numeric>
1        2 [100291831, 100295504] |      ID0015         4        18         1         0         1
2        2 [185114776, 185153675] |      ID0073         1        89         1         0         1
3        9 [122892486, 122913474] |      ID0028         1        37         1         0         1
4       22 [ 28281650,  28288327] |      ID0054         0        13         1         0         2
$allDel:
RangedData with 3 rows and 6 value columns across 3 spaces
     space                 ranges |          id        cn   numSnps       fid     score phenotype
  <factor>              <IRanges> | <character> <integer> <integer> <integer> <integer> <numeric>
1        2 [185114776, 185153675] |      ID0073         1        89         1         0         1
2        9 [122892486, 122913474] |      ID0028         1        37         1         0         1
3       22 [ 28281650,  28288327] |      ID0054         0        13         1         0         2
$allDup:
RangedData with 1 row and 6 value columns across 1 space
     space                 ranges |          id        cn   numSnps       fid     score phenotype
  <factor>              <IRanges> | <character> <integer> <integer> <integer> <integer> <numeric>
1        2 [100291831, 100295504] |      ID0015         4        18         1         0         1
$rareDEL:
RangedData with 3 rows and 6 value columns across 3 spaces
     space                 ranges |          id        cn   numSnps       fid     score phenotype
  <factor>              <IRanges> | <character> <integer> <integer> <integer> <integer> <numeric>
1        2 [185114776, 185153675] |      ID0073         1        89         1         0         1
2        9 [122892486, 122913474] |      ID0028         1        37         1         0         1
3       22 [ 28281650,  28288327] |      ID0054         0        13         1         0         2
$rareDUP:
RangedData with 1 row and 6 value columns across 1 space
     space                 ranges |          id        cn   numSnps       fid     score phenotype
  <factor>              <IRanges> | <character> <integer> <integer> <integer> <integer> <numeric>
1        2 [100291831, 100295504] |      ID0015         4        18         1         0         1
NULL

There were 36 warnings (use warnings() to see them)